# goph-keeper

# Запуск клиента
Для начала клиент необходимо собрать командой `make build-client`.
Бинарник для запуска клиента будет находиться по пути `cmd/client/gclient`.
Запустить клиент можно с помощью `make run-client`.

## Функции клиента

- login - функция авторизации на сервере. Необходима для получения токена.
- register - функция регистрации нового пользователя.
- logout - очистка пользовательского кэша и аутентификационных данных.
- records put [record_type] [path|data] [name] - отправка данных на сервер.
- records get [id] - получение данных с сервера, сохранение в кэш.
- records list - получение списка файлов с сервера.
- records sync - синхронизация данных между клиентом и сервером.

# Запуск сервера
Возможен запуск через docker compose:
- `docker compose up -d`

## Конфигурация приложения
- `-a` или `SERVER_ADDRESS` - указывает на адрес, который будет прослушивать сервер.
- `-g` или `LOG_LEVEL` - уровень логгирования.

## Данные
- Для запуска приложения потребуется доступ до БД Postgres, DSN необходимо передать через аргумент `-d` или переменную окружения `DATABASE_DSN`.
- Запустить локальный образ БД можно командой `make pg`.
- Остановка БД: `make stop-pg`. Очистить данные: `make clean-data`.
- Миграции применяются автоматически при запуске приложения.

## Сценарий использования
0. Запуск сервера и БД `docker compose up`.
1. Регистрация на сервере с помощью клиента: `./client_darwin64 register --api https://localhost:8080`
- создается локальный json файл с конфигурацией, содержащий в себе логин, токен аутентификации, адрес API gophkeeper
- создается локальная папка для синхронизации записей с сервером
2. Добавление данных: `./client_darwin64 records put pass login:password secretpassword`
3. Получение данных: `./client_darwin64 records get secretpassword`
4. При удалении локальной папки с записями можно воспользоваться командой `./client_darwin64 records sync` для восстановления записей с сервера.
